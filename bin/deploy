#!/bin/sh

set -eu

enc_auth_file = ${ENC_AUTH_FILE:-sfdx_auth_url.txt.enc}
test_level = ${TEST_LEVEL:-NoTestRun}
run_tests = ${RUN_TESTS:-NotSet}

if [ "${test_level}" = "RunSpecifiedTests" -a "${run_tests}" = "NotSet" ]
then
	echo "ERROR: Please specify Apex unit tests with run_tests argument"
	exit
fi

# Decrypt Auth URL File
#openssl enc -d -aes-256-cbc -in $enc_auth_file -out auth_url.txt -k $AUTH_FILE_KEY

# Authenticate DevHub Org
#sfdx force:auth:sfdxurl:store -f auth_url.txt -d -a TargetOrg && rm auth_url.txt

# Run validation deployment
#sfdx force:source:deploy -p force-app -u TargetOrg -l $test_level -w -1

echo "deploy"
echo "${enc_auth_file}"
echo "${test_level}"
echo "${run_tests}"